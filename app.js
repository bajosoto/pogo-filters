// Pokemon filter data - extracted from your script output
const FILTERS = {
    pve: {
        s: {
            nonShadow: "4,5,6,92,93,94,255,256,257,382,383,384,447,448,646,719,798,800,888,889&!shadow&!#&3*,4*",
            shadow: "111,112,150,371,372,373,383,408,409,464,483,484,485&shadow&!#&3*,4*"
        },
        a: {
            nonShadow: "1,2,3,7,8,9,16,17,18,63,64,65,111,112,142,150,179,180,181,214,220,221,228,229,246,247,248,252,253,254,258,259,260,280,281,282,309,310,353,354,359,361,362,371,372,373,374,375,376,380,381,382,383,384,408,409,443,444,445,447,448,459,460,464,473,475,478,483,484,485,491,532,533,534,607,608,609,633,634,635,636,637,639,643,644,717,720,789,790,791,792,796,806,891,894,895,996,997,998&!shadow&!#&3*,4*",
            shadow: "66,67,68,81,82,92,93,94,125,142,145,146,147,148,149,198,215,220,221,239,243,244,246,247,248,250,252,253,254,255,256,257,258,259,260,280,281,282,296,297,374,375,376,381,382,396,397,398,430,443,444,445,461,462,466,473,475,486,498,499,500,524,525,526,529,530,532,533,534,554,607,608,609,696,697,903&shadow&!#&3*,4*"
        },
        b: {
            nonShadow: "1,2,3,4,5,6,13,14,15,56,57,66,67,68,74,75,76,81,82,92,93,94,98,99,114,123,125,127,129,130,133,142,144,145,146,147,148,149,158,159,160,175,176,193,198,209,210,212,215,239,243,250,251,252,253,254,255,256,257,258,259,260,280,281,282,285,286,296,297,304,305,306,309,310,315,341,342,381,387,388,389,396,397,398,403,404,405,406,407,427,428,430,461,462,465,466,468,469,471,475,482,483,486,498,499,500,501,502,503,519,520,521,524,525,526,529,530,551,552,553,554,570,571,588,589,610,611,612,624,625,627,628,646,649,650,651,652,692,693,696,697,700,716,728,729,730,736,737,738,761,762,763,781,785,786,787,793,795,803,804,810,811,812,816,817,818,850,851,856,857,858,885,886,887,888,893,900,903,906,907,908,979,983&!shadow&!#&3*,4*",
            shadow: "1,2,3,4,5,6,7,8,9,37,38,43,44,45,56,57,58,59,63,64,65,69,70,71,74,75,76,102,103,114,123,126,127,129,130,137,144,155,156,157,158,159,160,179,180,181,182,200,209,210,212,228,229,233,240,249,273,274,275,304,305,306,309,310,318,319,328,329,330,331,332,353,354,359,380,387,388,389,390,391,392,393,394,395,403,404,405,429,434,435,453,454,459,460,465,467,474,501,502,503,519,520,521,622,623,900,979&shadow&!#&3*,4*"
        },
        c: {
            nonShadow: "4,5,6,25,26,63,64,65,69,70,71,74,75,76,83,95,102,103,124,127,129,130,133,135,155,156,157,172,196,208,211,238,244,249,280,281,282,331,332,333,334,353,354,359,385,390,391,392,393,394,395,475,494,511,512,522,523,566,567,602,603,604,616,617,624,625,627,628,638,640,653,654,655,656,657,658,720,721,731,732,733,744,865,904,909,910,911,983&!shadow&!#&3*,4*",
            shadow: "16,17,18,88,89,90,91,116,117,123,212,230,280,281,282,363,364,365,425,426,449,450,475,522,523,900&shadow&!#&3*,4*"
        },
        combined: {
            nonShadow: "1,2,3,4,5,6,7,8,9,13,14,15,16,17,18,25,26,56,57,63,64,65,66,67,68,69,70,71,74,75,76,81,82,83,92,93,94,95,98,99,102,103,111,112,114,123,124,125,127,129,130,133,135,142,144,145,146,147,148,149,150,155,156,157,158,159,160,172,175,176,179,180,181,193,196,198,208,209,210,211,212,214,215,220,221,228,229,238,239,243,244,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,280,281,282,285,286,296,297,304,305,306,309,310,315,331,332,333,334,341,342,353,354,359,361,362,371,372,373,374,375,376,380,381,382,383,384,385,387,388,389,390,391,392,393,394,395,396,397,398,403,404,405,406,407,408,409,427,428,430,443,444,445,447,448,459,460,461,462,464,465,466,468,469,471,473,475,478,482,483,484,485,486,491,494,498,499,500,501,502,503,511,512,519,520,521,522,523,524,525,526,529,530,532,533,534,551,552,553,554,566,567,570,571,588,589,602,603,604,607,608,609,610,611,612,616,617,624,625,627,628,633,634,635,636,637,638,639,640,643,644,646,649,650,651,652,653,654,655,656,657,658,692,693,696,697,700,716,717,719,720,721,728,729,730,731,732,733,736,737,738,744,761,762,763,781,785,786,787,789,790,791,792,793,795,796,798,800,803,804,806,810,811,812,816,817,818,850,851,856,857,858,865,885,886,887,888,889,891,893,894,895,900,903,904,906,907,908,909,910,911,979,983,996,997,998&!shadow&!#&3*,4*",
            shadow: "1,2,3,4,5,6,7,8,9,16,17,18,37,38,43,44,45,56,57,58,59,63,64,65,66,67,68,69,70,71,74,75,76,81,82,88,89,90,91,92,93,94,102,103,111,112,114,116,117,123,125,126,127,129,130,137,142,144,145,146,147,148,149,150,155,156,157,158,159,160,179,180,181,182,198,200,209,210,212,215,220,221,228,229,230,233,239,240,243,244,246,247,248,249,250,252,253,254,255,256,257,258,259,260,273,274,275,280,281,282,296,297,304,305,306,309,310,318,319,328,329,330,331,332,353,354,359,363,364,365,371,372,373,374,375,376,380,381,382,383,387,388,389,390,391,392,393,394,395,396,397,398,403,404,405,408,409,425,426,429,430,434,435,443,444,445,449,450,453,454,459,460,461,462,464,465,466,467,473,474,475,483,484,485,486,498,499,500,501,502,503,519,520,521,522,523,524,525,526,529,530,532,533,534,554,607,608,609,622,623,696,697,900,903,979&shadow&!#&3*,4*"
        }
    },
    gl: {
        s: {
            nonShadow: "183,184,194,195,298,345,346,355,356,477,629,630,957,958,959,980&!shadow&!#&0-1attack&3-defense&3-hp",
            shadow: "451,452&shadow&!#&0-1attack&3-defense&3-hp"
        },
        a: {
            nonShadow: "7,8,9,27,28,39,40,56,57,86,87,104,105,109,110,123,131,146,158,159,160,161,162,174,187,188,189,194,195,204,205,206,212,241,258,259,260,302,325,326,339,340,343,344,355,356,374,375,376,379,410,411,422,423,442,451,452,459,460,477,656,657,658,659,660,661,662,663,674,675,690,691,702,703,704,705,706,747,748,767,768,799,821,822,823,900,909,910,911,979,980,996,997,998&!shadow&!#&0-1attack&3-defense&3-hp",
            shadow: "7,8,9,27,28,56,57,95,104,105,109,110,131,155,156,157,158,159,160,187,188,189,194,195,204,205,207,208,258,259,260,302,325,326,339,340,355,356,459,460,472,477,622,623,979,980&shadow&!#&0-1attack&3-defense&3-hp"
        },
        b: {
            nonShadow: "1,2,3,35,36,37,38,66,67,68,95,104,105,108,133,167,168,170,171,173,175,176,197,207,208,211,307,308,357,361,362,363,364,365,377,425,426,463,468,472,478,488,495,496,497,546,547,595,596,622,623,624,625,669,670,671,686,687,698,699,782,783,784,895,904,919,920,926,927,938,939,962,983&!shadow&!#&0-1attack&3-defense&3-hp",
            shadow: "1,2,3,60,61,62,66,67,68,81,82,104,105,147,148,149,186,216,217,231,232,345,346,363,364,365,410,411,425,426,449,450,462,901&shadow&!#&0-1attack&3-defense&3-hp"
        },
        c: {
            nonShadow: "72,73,108,152,153,154,175,176,227,278,279,280,281,282,463,468,475,548,549,559,560,562,563,570,571,618,633,634,635,708,709,753,754,777,809,831,832,867,891,906,907,908,996,997,998&!shadow&!#&0-1attack&3-defense&3-hp",
            shadow: "66,67,68,69,70,71,377,484&shadow&!#&0-1attack&3-defense&3-hp"
        },
        combined: {
            nonShadow: "1,2,3,7,8,9,27,28,35,36,37,38,39,40,56,57,66,67,68,72,73,86,87,95,104,105,108,109,110,123,131,133,146,152,153,154,158,159,160,161,162,167,168,170,171,173,174,175,176,183,184,187,188,189,194,195,197,204,205,206,207,208,211,212,227,241,258,259,260,278,279,280,281,282,298,302,307,308,325,326,339,340,343,344,345,346,355,356,357,361,362,363,364,365,374,375,376,377,379,410,411,422,423,425,426,442,451,452,459,460,463,468,472,475,477,478,488,495,496,497,546,547,548,549,559,560,562,563,570,571,595,596,618,622,623,624,625,629,630,633,634,635,656,657,658,659,660,661,662,663,669,670,671,674,675,686,687,690,691,698,699,702,703,704,705,706,708,709,747,748,753,754,767,768,777,782,783,784,799,809,821,822,823,831,832,867,891,895,900,904,906,907,908,909,910,911,919,920,926,927,938,939,957,958,959,962,979,980,983,996,997,998&!shadow&!#&0-1attack&3-defense&3-hp",
            shadow: "1,2,3,7,8,9,27,28,56,57,60,61,62,66,67,68,69,70,71,81,82,95,104,105,109,110,131,147,148,149,155,156,157,158,159,160,186,187,188,189,194,195,204,205,207,208,216,217,231,232,258,259,260,302,325,326,339,340,345,346,355,356,363,364,365,377,410,411,425,426,449,450,451,452,459,460,462,472,477,484,622,623,901,979,980&shadow&!#&0-1attack&3-defense&3-hp"
        }
    },
    ul: {
        s: {
            nonShadow: "72,73,158,159,160,451,452,638,640,957,958,959&!shadow&!#&0-1attack&3-defense&3-hp",
            shadow: "158,159,160,451,452&shadow&!#&0-1attack&3-defense&3-hp"
        },
        a: {
            nonShadow: "1,2,3,7,8,9,27,28,29,30,31,35,36,56,57,95,108,109,110,131,133,146,173,197,204,205,208,241,325,326,345,346,355,356,379,422,423,463,477,488,629,630,656,657,658,661,662,663,674,675,686,687,690,691,698,699,767,768,799,821,822,823,909,910,911,938,939,962,979&!shadow&!#&0-1attack&3-defense&3-hp",
            shadow: "1,2,3,7,8,9,27,28,29,30,31,56,57,72,73,95,109,110,131,147,148,149,179,180,181,204,205,208,325,326,355,356,434,435,477,622,623,979&shadow&!#&0-1attack&3-defense&3-hp"
        },
        b: {
            nonShadow: "16,17,18,60,61,62,88,89,92,93,94,123,155,156,157,179,180,181,186,207,211,212,258,259,260,363,364,365,377,425,426,434,435,449,450,459,460,472,562,563,597,598,622,623,624,625,669,670,671,704,705,706,708,709,765,782,783,784,788,867,895,900,904,926,927,983,996,997,998&!shadow&!#&0-1attack&3-defense&3-hp",
            shadow: "37,38,66,67,68,88,89,92,93,94,155,156,157,216,217,258,259,260,345,346,363,364,365,449,450,459,460,488,901&shadow&!#&0-1attack&3-defense&3-hp"
        },
        c: {
            nonShadow: "37,38,66,67,68,77,78,152,153,154,231,232,343,344,378,548,549,570,571,592,593,618,785,809,891,906,907,908&!shadow&!#&0-1attack&3-defense&3-hp",
            shadow: "60,61,62,186,280,281,282,377,379,425,426,475,484&shadow&!#&0-1attack&3-defense&3-hp"
        },
        combined: {
            nonShadow: "1,2,3,7,8,9,16,17,18,27,28,29,30,31,35,36,37,38,56,57,60,61,62,66,67,68,72,73,77,78,88,89,92,93,94,95,108,109,110,123,131,133,146,152,153,154,155,156,157,158,159,160,173,179,180,181,186,197,204,205,207,208,211,212,231,232,241,258,259,260,325,326,343,344,345,346,355,356,363,364,365,377,378,379,422,423,425,426,434,435,449,450,451,452,459,460,463,472,477,488,548,549,562,563,570,571,592,593,597,598,618,622,623,624,625,629,630,638,640,656,657,658,661,662,663,669,670,671,674,675,686,687,690,691,698,699,704,705,706,708,709,765,767,768,782,783,784,785,788,799,809,821,822,823,867,891,895,900,904,906,907,908,909,910,911,926,927,938,939,957,958,959,962,979,983,996,997,998&!shadow&!#&0-1attack&3-defense&3-hp",
            shadow: "1,2,3,7,8,9,27,28,29,30,31,37,38,56,57,60,61,62,66,67,68,72,73,88,89,92,93,94,95,109,110,131,147,148,149,155,156,157,158,159,160,179,180,181,186,204,205,208,216,217,258,259,260,280,281,282,325,326,345,346,355,356,363,364,365,377,379,425,426,434,435,449,450,451,452,459,460,475,477,484,488,622,623,901,979&shadow&!#&0-1attack&3-defense&3-hp"
        }
    },
    ml: {
        s: {
            nonShadow: "111,112,250,464,484,646,888,889&!shadow&!#&3*,4*",
            shadow: "111,112,464&shadow&!#&3*,4*"
        },
        a: {
            nonShadow: "150,382,383,483,643,646,669,670,671,717,728,729,730,789,790,791,792,800,891,999,1000&!shadow&!#&3*,4*",
            shadow: "150,250,484&shadow&!#&3*,4*"
        },
        b: {
            nonShadow: "56,57,129,130,146,147,148,149,158,159,160,175,176,216,217,220,221,249,258,259,260,374,375,376,443,444,445,449,450,468,473,483,484,485,624,625,633,634,635,644,646,649,704,705,706,712,713,716,720,767,768,782,783,784,786,787,793,800,809,885,886,887,888,889,893,901,909,910,911,974,975,979,983,996,997,998&!shadow&!#&3*,4*",
            shadow: "56,57,129,130,143,145,147,148,149,158,159,160,215,216,217,220,221,246,247,248,377,381,382,383,446,461,473,483,802,901,903,979&shadow&!#&3*,4*"
        },
        c: {
            nonShadow: "144,145,246,247,248,377,381,384,674,675,788&!shadow&!#&3*,4*",
            shadow: "243,258,259,260,443,444,445,529,530&shadow&!#&3*,4*"
        },
        combined: {
            nonShadow: "56,57,111,112,129,130,144,145,146,147,148,149,150,158,159,160,175,176,216,217,220,221,246,247,248,249,250,258,259,260,374,375,376,377,381,382,383,384,443,444,445,449,450,464,468,473,483,484,485,624,625,633,634,635,643,644,646,649,669,670,671,674,675,704,705,706,712,713,716,717,720,728,729,730,767,768,782,783,784,786,787,788,789,790,791,792,793,800,809,885,886,887,888,889,891,893,901,909,910,911,974,975,979,983,996,997,998,999,1000&!shadow&!#&3*,4*",
            shadow: "56,57,111,112,129,130,143,145,147,148,149,150,158,159,160,215,216,217,220,221,243,246,247,248,250,258,259,260,377,381,382,383,443,444,445,446,461,464,473,483,484,529,530,802,901,903,979&shadow&!#&3*,4*"
        }
    }
};

// App state
let currentCategory = null;
let currentTier = null;
let isScreens = {
    main: true,
    tier: false,
    filter: false
};

// DOM elements
const mainMenu = document.getElementById('main-menu');
const tierMenu = document.getElementById('tier-menu');
const filterDisplay = document.getElementById('filter-display');
const categoryTitle = document.getElementById('category-title');
const filterTitle = document.getElementById('filter-title');
const filterText = document.getElementById('filter-text');
const shadowToggle = document.getElementById('shadow-toggle');
const copyBtn = document.getElementById('copy-btn');
const copySuccess = document.getElementById('copy-success');
const backBtn = document.getElementById('back-btn');
const filterBackBtn = document.getElementById('filter-back-btn');

// Category names mapping
const categoryNames = {
    pve: 'PvE (Raids/Gyms)',
    gl: 'Great League',
    ul: 'Ultra League',
    ml: 'Master League'
};

// Tier names mapping
const tierNames = {
    s: 'S Tier',
    a: 'A Tier',
    b: 'B Tier',
    c: 'C Tier',
    combined: 'Combined All Tiers'
};

// Screen management
function showScreen(screen) {
    mainMenu.classList.toggle('hidden', screen !== 'main');
    tierMenu.classList.toggle('hidden', screen !== 'tier');
    filterDisplay.classList.toggle('hidden', screen !== 'filter');

    isScreens.main = screen === 'main';
    isScreens.tier = screen === 'tier';
    isScreens.filter = screen === 'filter';
}

// Event listeners
document.addEventListener('DOMContentLoaded', function() {
    // Category button clicks
    document.querySelectorAll('.category-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            currentCategory = this.dataset.category;
            categoryTitle.textContent = categoryNames[currentCategory];
            showScreen('tier');
        });
    });

    // Tier button clicks
    document.querySelectorAll('.tier-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            currentTier = this.dataset.tier;
            updateFilter();
            showScreen('filter');
        });
    });

    // Shadow toggle
    shadowToggle.addEventListener('change', function() {
        if (currentCategory && currentTier) {
            updateFilter();
        }
    });

    // Copy button
    copyBtn.addEventListener('click', function() {
        copyToClipboard();
    });

    // Back buttons
    backBtn.addEventListener('click', function() {
        showScreen('main');
    });

    filterBackBtn.addEventListener('click', function() {
        showScreen('tier');
    });
});

function updateFilter() {
    const isShadow = shadowToggle.checked;
    const filterKey = isShadow ? 'shadow' : 'nonShadow';
    const filter = FILTERS[currentCategory][currentTier][filterKey];

    filterText.value = filter;

    const shadowText = isShadow ? ' (Shadow)' : ' (Non-Shadow)';
    filterTitle.textContent = `${categoryNames[currentCategory]} ${tierNames[currentTier]}${shadowText}`;
}

async function copyToClipboard() {
    try {
        await navigator.clipboard.writeText(filterText.value);
        showCopySuccess();
    } catch (err) {
        // Fallback for older browsers
        filterText.select();
        document.execCommand('copy');
        showCopySuccess();
    }
}

function showCopySuccess() {
    copySuccess.classList.remove('hidden');
    setTimeout(() => {
        copySuccess.classList.add('hidden');
    }, 2000);
}

// Register service worker for PWA functionality
if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('service-worker.js')
        .then(registration => console.log('SW registered'))
        .catch(error => console.log('SW registration failed'));
}
